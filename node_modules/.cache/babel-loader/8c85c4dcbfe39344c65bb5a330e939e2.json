{"ast":null,"code":"import _objectSpread from \"/home/shadows/Documents/wdi4/Project-4/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/home/shadows/Documents/wdi4/Project-4/frontend/src/App.js\";\nimport React, { Component } from 'react';\nimport './App.css';\nimport axios from \"axios\";\nimport Home from \"./Home\";\nimport Show from \"./components/Show\";\nimport Login from \"./components/Login\";\nimport Signup from \"./components/Signup\";\nimport { getToken, setToken, logout } from './services/auth';\nimport { BrowserRouter as Router, Route, Link } from 'react-router-dom'; //header file for auth\n\nlet header = {\n  headers: {\n    \"Content-Type\": \"application/json\",\n    \"Authorization\": \"Bearer \".concat(getToken())\n  }\n};\n\nclass App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      id: [],\n      title: [],\n      url: [],\n      train_score: [],\n      test_score: [],\n      user: \"\",\n      errorMsg: '',\n      isAuthenticated: false,\n      hasError: false\n    };\n\n    this.changeHandler = e => {\n      //Log every key value and save to state from form\n      let data = _objectSpread({}, this.state);\n\n      data[e.target.name] = e.target.value;\n      this.setState(data);\n    };\n\n    this.logout = () => {\n      let data = _objectSpread({}, this.state); //reset everything on logout\n\n\n      data.isAuthenticated = false;\n      data.user = \"\";\n      data.email = \"\";\n      data.password = \"\";\n      setToken(\"\");\n      this.setState(data);\n    };\n\n    this.getData = () => {\n      if (this.state.id[0]) return null;\n      axios.get('main/', header).then(data => {\n        let newState = _objectSpread({}, this.state);\n\n        data.data.datum.forEach(item => {\n          newState.id.push(item._id);\n          newState.title.push(item.title);\n          newState.train_score.push(item.train_acc);\n          newState.test_score.push(item.test_acc);\n          newState.url.push('http://placehold.it/300x300');\n        });\n        this.setState(newState);\n      });\n    };\n\n    this.loginHandler = e => {\n      e.preventDefault();\n      axios.post('auth/login', {\n        email: this.state.email,\n        password: this.state.password\n      }).then(response => {\n        if (response.data.token) {\n          setToken(response.data.token);\n\n          let data = _objectSpread({}, this.state);\n\n          data.user = response.data.username;\n          data.isAuthenticated = true;\n          data.hasError = false;\n          this.setState(data);\n          window.location.reload();\n          this.getData();\n        }\n      }).catch(err => {\n        let data = _objectSpread({}, this.state);\n\n        data.hasError = true;\n        this.setState(data);\n      });\n    };\n\n    this.registerHandler = ({\n      history\n    }) => {\n      e.preventDefault();\n      axios.post('auth/register', {\n        username: this.state.username,\n        password: this.state.password,\n        email: this.state.email\n      }).then(response => {\n        console.log(response);\n        window.history.push('/');\n      }).catch(err => {\n        console.log(err);\n        window.history.push('/');\n      });\n    };\n  }\n\n  componentWillMount() {\n    if (getToken()) {\n      let data = _objectSpread({}, this.state);\n\n      data.isAuthenticated = true;\n      data.hasError = false;\n      this.setState(data);\n    }\n  }\n\n  render() {\n    const logged = this.state.isAuthenticated ? React.createElement(Link, {\n      className: \"text-white logout\",\n      onClick: this.logout,\n      to: \"/\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, \"Logout\") : React.createElement(Link, {\n      to: \"/signup\",\n      className: \"text-white\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, \"Signup\");\n    const isAuth = this.state.isAuthenticated ? React.createElement(Home, {\n      state: this.state,\n      getData: this.getData,\n      that: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }) : React.createElement(Login, {\n      change: this.changeHandler,\n      login: this.loginHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    });\n    console.log(this.state.isAuthenticated);\n    return React.createElement(\"div\", {\n      className: \"background-app\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, React.createElement(Router, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, React.createElement(\"nav\", {\n      className: \"bg-dark p-1 d-flex flex-row justify-content-between\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }, React.createElement(Link, {\n      to: \"/\",\n      className: \"text-white\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, \"Home\"), logged), React.createElement(Route, {\n      exact: true,\n      path: \"/\",\n      render: () => isAuth,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/show/:id\",\n      render: () => React.createElement(Show, {\n        auth: this.state.isAuthenticated,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }), React.createElement(Route, {\n      path: \"/signup\",\n      render: () => React.createElement(Signup, {\n        change: this.changeHandler,\n        register: this.registerHandler,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    })));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/home/shadows/Documents/wdi4/Project-4/frontend/src/App.js"],"names":["React","Component","axios","Home","Show","Login","Signup","getToken","setToken","logout","BrowserRouter","Router","Route","Link","header","headers","App","state","id","title","url","train_score","test_score","user","errorMsg","isAuthenticated","hasError","changeHandler","e","data","target","name","value","setState","email","password","getData","get","then","newState","datum","forEach","item","push","_id","train_acc","test_acc","loginHandler","preventDefault","post","response","token","username","window","location","reload","catch","err","registerHandler","history","console","log","componentWillMount","render","logged","isAuth"],"mappings":"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","sourcesContent":["import React,{ Component } from 'react';\nimport './App.css';\nimport axios from \"axios\"\nimport Home from \"./Home\"\nimport Show from \"./components/Show\"\nimport Login from \"./components/Login\"\nimport Signup from \"./components/Signup\"\nimport { getToken, setToken, logout} from './services/auth'\nimport {\n  BrowserRouter as Router,\n  Route,\n  Link,\n} from 'react-router-dom'\n\n//header file for auth\nlet header = {\n  headers :{\n    \"Content-Type\" : \"application/json\",\n    \"Authorization\" : `Bearer ${getToken()}`\n  }\n}\n\n\nclass App extends Component {\n  state={\n    id:[],\n    title:[],\n    url:[],\n    train_score:[],\n    test_score:[],\n    user : \"\",\n    errorMsg : '',\n    isAuthenticated : false,\n    hasError : false\n  }\n\n  changeHandler = (e) => {\n    //Log every key value and save to state from form\n    let data = {...this.state}\n    data[e.target.name] = e.target.value\n\n    this.setState(data)\n  }\n\n  \n  logout = () =>{\n    let data = {...this.state}\n    //reset everything on logout\n    data.isAuthenticated = false\n    data.user = \"\"\n    data.email = \"\"\n    data.password = \"\"\n    setToken(\"\")\n\n    this.setState(data)\n\n  }\n\n  getData=()=>{\n    if (this.state.id[0])return null\n    axios.get('main/',header)\n    .then(data=>{\n      let newState={...this.state}\n      data.data.datum.forEach((item)=>{\n        newState.id.push(item._id)\n        newState.title.push(item.title)\n        newState.train_score.push(item.train_acc)\n        newState.test_score.push(item.test_acc)\n        newState.url.push('http://placehold.it/300x300')\n      })\n      \n      this.setState(newState)\n    })\n  }\n\n  loginHandler = (e) => {\n    e.preventDefault()\n    axios.post('auth/login',{ email: this.state.email, password: this.state.password})\n    .then( response => {\n      if(response.data.token){\n        setToken(response.data.token)\n        \n        let data = {...this.state}\n        data.user = response.data.username\n        data.isAuthenticated = true\n        data.hasError = false\n\n        this.setState(data)\n        window.location.reload()\n        this.getData()\n      }\n      \n    })\n    .catch(err =>{\n      let data = {...this.state}\n        data.hasError = true\n        this.setState(data)\n\n    })\n  }\n\n  registerHandler = ({history}) => {\n    e.preventDefault()\n    axios.post('auth/register',{username:this.state.username,password:this.state.password,email:this.state.email})\n    .then( response => {\n      console.log(response)\n      window.history.push('/')\n      \n    })\n    .catch(err=>{\n      console.log(err)\n      window.history.push('/')\n\n    })\n  }\n\n  componentWillMount(){\n    if (getToken()){\n      let data = {...this.state}\n      data.isAuthenticated = true\n      data.hasError = false\n      \n      this.setState(data)\n    }\n  }\n\n  render() {\n    const logged=(this.state.isAuthenticated)?<Link className='text-white logout' onClick={this.logout} to='/' >Logout</Link>:<Link to='/signup' className='text-white'>Signup</Link>;\n    const isAuth=(this.state.isAuthenticated)?<Home state={this.state} getData={this.getData} that={this} />:<Login change={this.changeHandler} login={this.loginHandler} />;\n    console.log(this.state.isAuthenticated)\n    return (\n      <div className='background-app'>\n      <Router>\n      <nav className='bg-dark p-1 d-flex flex-row justify-content-between'>\n        <Link to='/' className='text-white'>Home</Link>\n        {logged}\n      </nav>\n        <Route exact path='/' render={()=>isAuth} />\n        <Route path='/show/:id' render={()=><Show auth={this.state.isAuthenticated} />} />\n        <Route path='/signup' render={()=><Signup change={this.changeHandler} register={this.registerHandler} />} />\n      </Router>\n      </div>\n    )\n  }\n}\n\n\n\nexport default App"]},"metadata":{},"sourceType":"module"}